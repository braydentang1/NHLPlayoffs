year = 2008
data = read_csv(paste("C:/Users/Brayden/Documents/NHLModel/All Team Stats/", year,".csv", sep = ""))
require(tidyverse)
require(rvest)
template = read_csv("C:/Users/Brayden/Documents/NHLModel/Scraping Scripts and Template/Template.csv") %>%
mutate_all(funs(str_replace(., "Mighty Ducks of Anaheim", "Anaheim Ducks"))) %>%
mutate_all(funs(str_replace(., "Phoenix Coyotes", "Arizona Coyotes")))
accronyms_pg = read_html("https://en.wikipedia.org/wiki/Template:NHL_team_abbreviations")
accronyms = accronyms_pg %>%
html_nodes(".column-width li") %>%
html_text(.) %>%
substr(., 1,3)
fullnames = accronyms_pg %>%
html_nodes(".column-width li") %>%
html_text(.) %>%
substr(., 7, 1000000L)
lookup_Accronyms = cbind(FullName = fullnames, Team = accronyms) %>%
as_tibble(.) %>%
bind_rows(., c(FullName = "Mighty Ducks of Anaheim", Team = "MDA"))
rm(accronyms_pg, accronyms, fullnames)
data = read_csv(paste("C:/Users/Brayden/Documents/NHLModel/All Team Stats/", year,".csv", sep = ""))
View(data)
View(data)
data[data == "L.A"] = "LAK"
View(data)
data = read_csv(paste("C:/Users/Brayden/Documents/NHLModel/All Team Stats/", year,".csv", sep = "")) %>%
.[. == "L.A"] = "LAK"
data = read_csv(paste("C:/Users/Brayden/Documents/NHLModel/All Team Stats/", year,".csv", sep = "")) %>%
data[data == "L.A"] = "LAK"
data = read_csv(paste("C:/Users/Brayden/Documents/NHLModel/All Team Stats/", year,".csv", sep = ""))
data[data == "L.A"] = "LAK"
View(lookup_Accronyms)
require(tidyverse)
require(rvest)
template = read_csv("C:/Users/Brayden/Documents/NHLModel/Scraping Scripts and Template/Template.csv") %>%
mutate_all(funs(str_replace(., "Mighty Ducks of Anaheim", "Anaheim Ducks"))) %>%
mutate_all(funs(str_replace(., "Phoenix Coyotes", "Arizona Coyotes")))
accronyms_pg = read_html("https://en.wikipedia.org/wiki/Template:NHL_team_abbreviations")
accronyms = accronyms_pg %>%
html_nodes(".column-width li") %>%
html_text(.) %>%
substr(., 1,3)
fullnames = accronyms_pg %>%
html_nodes(".column-width li") %>%
html_text(.) %>%
substr(., 7, 1000000L)
lookup_Accronyms = cbind(FullName = fullnames, Team = accronyms) %>%
as_tibble(.) %>%
bind_rows(., c(FullName = "Mighty Ducks of Anaheim", Team = "MDA")) %>%
mutate(FullName = ifelse(FullName == "St. Louis Blues", "St Louis Blues", FullName))
rm(accronyms_pg, accronyms, fullnames)
View(template)
View(lookup_Accronyms)
data = read_csv(paste("C:/Users/Brayden/Documents/NHLModel/All Team Stats/", year,".csv", sep = ""))
data[data == "L.A"] = "LAK"
data[data == "N.J"] = "NJD"
data[data == "S.J"] = "SJS"
data[data == "T.B"] = "TBL"
View(data)
View(data)
View(template)
team.1 = "Dallas Stars"
team.2 = "Anaheim Ducks"
View(template)
highest.seed = "Anaheim Ducks"
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
CF._Team = data$"CF%"[which(data$Team == teamAcc[1])]
highestseedAcc = teamAcc[which(teamAcc == highest.seed)]
highestseedAcc = lookup_Accronyms$Team[which(lookup_Accronyms$FullName == highest.seed)]
CF._Team = data$"CF%"[which(data$Team == highest.seed)] - data$"CF%"[which(data$Team != highest.seed & any(teamAcc))]
CF._Team = data$"CF%"[which(data$Team == highest.seed)]
data$"CF%"[which(data$Team != highest.seed & any(teamAcc))]
data$"CF%"[which(data$Team != highest.seed & (data$Team == team.1 | data$team == team.2))]
data$"CF%"[which(data$Team != highest.seed & (data$Team == team.1 | data$Team == team.2))]
data$"CF%"[which(data$Team != highest.seed & (data$Team == teamAcc[1] | data$Team == teamAcc[2]))]
CF._Team = data$"CF%"[which(data$Team == highest.seed)] - data$"CF%"[which(data$Team != highest.seed & (data$Team == teamAcc[1] | data$Team == teamAcc[2]))]
CF._Team = data$"CF%"[which(data$Team == highest.seedAcc)]
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
highestseedAcc = lookup_Accronyms$Team[which(lookup_Accronyms$FullName == highest.seed)]
CF._Team = data$"CF%"[which(data$Team == highest.seedAcc)]
CF._Team = data$"CF%"[which(data$Team == highestseedAcc)]
highestseed = which(highestseedAcc == teamAcc)
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1 & lookup_Accronyms == highest.seed)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1 & lookup_Accronyms == highest.seed)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1 & lookup_Accronyms == highest.seed)]
lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)]
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1 & lookup_Accronyms$FullName == highest.seed)],
lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2 & lookup_Accronyms$FullName != highest.seed)])
lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1 & lookup_Accronyms$FullName == highest.seed)]
which(lookup_Accronyms$FullName == team.1 & lookup_Accronyms$FullName == highest.seed)
lookup_Accronyms$FullName == highest.seed
lookup_Accronyms$FullName == team.1
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == highest.seed)],
lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2 & lookup_Accronyms$FullName != highest.seed)])
lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2 & lookup_Accronyms$FullName != highest.seed)]
teamAcc = c(data$Team[which(data$Team == team.1)], data$Team[which(data$Team == team.2)])
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
highestseed = teamAcc[which(lookup_Accronyms$FullName == highest.seed)]
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
highestseedAcc = teamAcc[which(lookup_Accronyms$FullName == highest.seed)]
CF._Team = data$"CF%"[which(data$Team == highestseedAcc)]
CF._Team = data$"CF%"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])]
CF._Team = data$"CF%"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF%"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])]
data$"CF%"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])]
which(teamAcc != highestseedAcc)
teamAcc[which(teamAcc != highestseedAcc)]
CF._Team = data$"CF%"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF%"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])]
CF._Team = data$"CF%"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF%"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])]
CF_Per60Team = data$"CF/60"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF/60"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])]
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
highestseedAcc = teamAcc[which(lookup_Accronyms$FullName == highest.seed)]
list(CF._Team = data$"CF%"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF%"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])],
CF_Per60Team = data$"CF/60"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF/60"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])],
CA_Per60Team = data$"CA/60"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CA/60"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])])
require(tidyverse)
require(rvest)
template = read_csv("C:/Users/Brayden/Documents/NHLModel/Scraping Scripts and Template/Template.csv") %>%
mutate_all(funs(str_replace(., "Mighty Ducks of Anaheim", "Anaheim Ducks"))) %>%
mutate_all(funs(str_replace(., "Phoenix Coyotes", "Arizona Coyotes")))
accronyms_pg = read_html("https://en.wikipedia.org/wiki/Template:NHL_team_abbreviations")
accronyms = accronyms_pg %>%
html_nodes(".column-width li") %>%
html_text(.) %>%
substr(., 1,3)
fullnames = accronyms_pg %>%
html_nodes(".column-width li") %>%
html_text(.) %>%
substr(., 7, 1000000L)
lookup_Accronyms = cbind(FullName = fullnames, Team = accronyms) %>%
as_tibble(.) %>%
bind_rows(., c(FullName = "Mighty Ducks of Anaheim", Team = "MDA")) %>%
mutate(FullName = ifelse(FullName == "St. Louis Blues", "St Louis Blues", FullName))
rm(accronyms_pg, accronyms, fullnames)
getData = function(year){
data = read_csv(paste("C:/Users/Brayden/Documents/NHLModel/All Team Stats/", year,".csv", sep = ""))
data[data == "L.A"] = "LAK"
data[data == "N.J"] = "NJD"
data[data == "S.J"] = "SJS"
data[data == "T.B"] = "TBL"
bind_cols(tibble(Year = rep(year, nrow(data)), data))
}
allData = bind_rows(lapply(2008:2018, getData))
lapply(2008:2018, getData)
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
View(allData)
processData = function(team.1, team.2, highest.seed, year, data){
data = data %>%
filter(., Year == year)
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
highestseedAcc = teamAcc[which(lookup_Accronyms$FullName == highest.seed)]
list(CF._Team = data$"CF%"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF%"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])],
CF_Per60Team = data$"CF/60"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF/60"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])],
CA_Per60Team = data$"CA/60"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CA/60"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])])
}
final = mapply(processData, team.1 = template$Team1, team.2 = template$Team2, highest.seed = template$Highest.Seed, year = template$Year, MoreArgs = list(data = allData), SIMPLIFY = FALSE)
View(final)
final[["Ottawa Senators"]]
final[["Winnipeg Jets"]]
final = bind_rows(mapply(processData, team.1 = template$Team1, team.2 = template$Team2, highest.seed = template$Highest.Seed, year = template$Year, MoreArgs = list(data = allData), SIMPLIFY = FALSE))
View(final)
View(allData)
View(template)
View(allData)
View(final)
final = mapply(processData, team.1 = template$Team1, team.2 = template$Team2, highest.seed = template$Highest.Seed, year = template$Year, MoreArgs = list(data = allData), SIMPLIFY = FALSE)
View(final)
team.1 = "Pittsburgh Penguins"
team.2 = "Nashville Predators"
highest.seed = "Pittsburgh Penguins"
year = 2017
data = allData
data = data %>%
filter(., Year == year)
View(data)
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
highestseedAcc = teamAcc[which(lookup_Accronyms$FullName == highest.seed)]
View(lookup_Accronyms)
highestseedAcc = teamAcc[which(lookup_Accronyms$FullName == highest.seed)]
which(lookup_Accronyms$FullName == highest.seed)
highestseedAcc = teamAcc[which(lookup_Accronyms$FullName == highest.seed)]
which(lookup_Accronyms$FullName == highest.seed)
lookup_Accronyms$Team[which(lookup_Accronyms$FullName == highest.seed)]
data = data %>%
filter(., Year == year)
teamAcc = c(lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.1)], lookup_Accronyms$Team[which(lookup_Accronyms$FullName == team.2)])
highestseedAcc = teamAcc[which(teamAcc == lookup_Accronyms$Team[which(lookup_Accronyms$FullName == highest.seed)])]
list(CF._Team = data$"CF%"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF%"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])],
CF_Per60Team = data$"CF/60"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CF/60"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])],
CA_Per60Team = data$"CA/60"[which(data$Team == teamAcc[which(teamAcc == highestseedAcc)])] - data$"CA/60"[which(data$Team == teamAcc[which(teamAcc != highestseedAcc)])])
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
mapply(processData, team.1 = template$Team1, team.2 = template$Team2, highest.seed = template$Highest.Seed, year = template$Year, MoreArgs = list(data = allData), SIMPLIFY = FALSE)
final = mapply(processData, team.1 = template$Team1, team.2 = template$Team2, highest.seed = template$Highest.Seed, year = template$Year, MoreArgs = list(data = allData), SIMPLIFY = FALSE)
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
View(final)
final[["Montreal Canadiens"]]
final[["Washington Capitals"]]
final[["Edmonton Oilers"]]
final = bind_rows(mapply(processData, team.1 = template$Team1, team.2 = template$Team2, highest.seed = template$Highest.Seed, year = template$Year, MoreArgs = list(data = allData), SIMPLIFY = FALSE))
View(final)
data = allData
team.1 = "Ottawa Senators"
team.2 = "Tampa Bay Lightning"
year = 2006
highest.seed = "Ottawa Senators"
data = data %>%
filter(., Year == year)
data = allData
View(data)
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
View(final)
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
source('~/GitHub/NHLPlayoffs/Scraping Scipts and Template/CorsicaAllTeamStats.R', echo=TRUE)
